# Router Selection Feature

WentPlate now supports multiple HTTP routers with automatic selection based on environment configuration.

## Supported Routers

- **Gin** (github.com/gin-gonic/gin) - Default
- **Chi** (github.com/go-chi/chi/v5) - Alternative

## Configuration

### 1. Via .env File (Recommended)

Create a `.env` file in your project root:

```bash
# Generated by WentPlate
# Router configuration
ROUTER=gin    # or 'chi'
```

### 2. Via Command Line Flags

When creating a new project:

```bash
./went new --router gin
./went new --router chi
./went new -R gin
./went new -R chi
```

### 3. Via Interactive Selection

Run `./went new` and select your preferred router from the interactive menu.

## How It Works

### Controller Generation

When generating controllers with `make:controller`, WentPlate:

1. **Reads .env file** in the current directory
2. **Looks for ROUTER** environment variable
3. **Defaults to gin** if:
   - No .env file exists
   - ROUTER variable is empty
   - ROUTER variable is not found
4. **Shows error** if ROUTER has invalid value (not 'gin' or 'chi')

### Example Usage

```bash
# Create .env with router preference
echo "ROUTER=chi" > .env

# Generate controller - uses Chi router
./went make:controller User
# Output: [OK] Controller 'UserController' created successfully using chi router!

# Change router preference
echo "ROUTER=gin" > .env

# Generate another controller - uses Gin router
./went make:controller Product
# Output: [OK] Controller 'ProductController' created successfully using gin router!

# Invalid router value
echo "ROUTER=express" > .env
./went make:controller Test
# Output: [ERROR] Invalid ROUTER definition in .env file: 'express'
#         Valid options are: 'gin' or 'chi'
```

## Template Differences

### Gin Controller Template (`controller_gin.tpl`)

- Uses `gin.Context` for request/response handling
- HTTP methods: `ctx.JSON()`, `ctx.ShouldBindJSON()`, `ctx.Param()`
- Framework: `github.com/gin-gonic/gin`
- Route definition: Built into controller methods

Example Gin controller method:
```go
func (c *UserController) Show(ctx *gin.Context) {
    id := ctx.Param("id")
    // ... logic ...
    ctx.JSON(http.StatusOK, gin.H{"data": user})
}
```

### Chi Controller Template (`controller_chi.tpl`)

- Uses standard `http.ResponseWriter` and `http.Request`
- HTTP methods: `json.NewEncoder().Encode()`, `json.NewDecoder().Decode()`, `chi.URLParam()`
- Framework: `github.com/go-chi/chi/v5`
- Route definition: Separate `Routes()` method returns `chi.Router`

Example Chi controller method:
```go
func (c *UserController) Show(w http.ResponseWriter, r *http.Request) {
    id := chi.URLParam(r, "id")
    // ... logic ...
    c.jsonResponse(w, http.StatusOK, map[string]interface{}{"data": user})
}

func (c *UserController) Routes() chi.Router {
    r := chi.NewRouter()
    r.Get("/{id}", c.Show)
    // ... more routes ...
    return r
}
```

## Project Generation

When creating a new project with `./went new`, the router selection is saved to:

1. **wentconfig.json** - Project configuration
2. **.env file** - Environment variables for the generated project

This ensures that future `make:controller` commands in that project use the same router.

## Migration Between Routers

To switch routers in an existing project:

1. Update `.env` file with new ROUTER value
2. Regenerate controllers with new router template
3. Update route definitions in your main application file

## Error Handling

### Invalid Router Values

```bash
$ echo "ROUTER=express" > .env
$ ./went make:controller Test

[ERROR] Invalid ROUTER definition in .env file: 'express'
Valid options are: 'gin' or 'chi'
If no .env file exists or ROUTER is empty, 'gin' will be used as default
```

### Valid Router Values

- `gin` (case insensitive)
- `chi` (case insensitive)
- Empty or missing defaults to `gin`

## Benefits

1. **Framework Flexibility**: Choose the HTTP router that fits your project needs
2. **Consistent Generation**: All controllers in a project use the same router
3. **Easy Switching**: Change router preference via simple .env file update
4. **Backward Compatibility**: Defaults to Gin (original behavior)
5. **Developer Choice**: Both Gin and Chi are excellent frameworks with different philosophies

## Router Comparison

| Feature | Gin | Chi |
|---------|-----|-----|
| **Performance** | Very Fast | Very Fast |
| **Middleware** | Built-in | Composable |
| **JSON Handling** | Built-in helpers | Manual |
| **Route Groups** | Native support | Subrouters |
| **Learning Curve** | Beginner friendly | Standard Go patterns |
| **Community** | Large | Growing |
| **Philosophy** | Framework | Toolkit |

Choose Gin for: Rapid development, built-in features, beginner-friendly API
Choose Chi: Standard library patterns, composable middleware, minimalist approach
